document.addEventListener('DOMContentLoaded', function() {
    // Sample publication data - replace with your actual data or API call
    const publications = [
        {
            id: 1,
            title: "Адвокаты АК «АРГУС» добились применения принципа Res Judicata арбитражным судом",
            date: "2025-05-15",
            content: "<p>При участии адвокатов АК АРГУС было отменено решение третейского суда (МКАС при ТПП РФ) о взыскании долга в размере более трехсот пятидесяти миллионов рублей. По результатам рассмотрения дела в Верховном Суде РФ аргументы наших адвокатов были признаны обоснованными, дело направлено на новое рассмотрение.</p><p>Основанием для отмены судебных актов послужило то, что по рассмотренным судами спорным обстоятельствам уже было принято решение международного коммерческого арбитража. Адвокатам удалось доказать, что приведение в исполнение данного решения нарушило бы такие принципы публичного порядка РФ, как принцип законной силы судебного акта, в части его окончательности и неопровержимости (res judicata), принцип правовой определенности.</p><p>При новом рассмотрении дела решение МКАС было отменено как противоречащее публичному порядку РФ, в выдаче исполнительного листа было отказано.</p><p>Рассмотрение дела по спору об отмене решения третейского суда (МКАС при ТПП РФ) вызвало значительный интерес и у юристов, и у правовых изданий. В частности, публикации о ходе рассмотрения данного дела, в том числе с неоднозначными комментариями, появились в следующих изданиях: Pravo.ru, Zakon.ru, Газета.ru, Practical Law Arbitration, Журнал Arbitration.ru.</p><p>Адвокаты АК АРГУС за участие в данном деле были награждены Почетными дипломами Адвокатской Палаты Санкт-Петербурга.</p>"
        },
        {
            id: 2,
            title: "Адвокаты АК «АРГУС» доказали необходимость применения тарифов «для населения» исходя из назначения ппомещения в деле о взыскании с юридического лица платы за поставленные теплоресурсы",  
            date: "2024-03-22",
            content: "<p>При участии адвокатов АК АРГУС (pro bono) был выигран спор, связанный с разногласиями сторон (теплоснабжающая организация и юридическое лицо, владеющее административно-бытовым зданием с общежитием) по варианту тарифа, подлежащего применению при расчете стоимости тепловой энергии для здания, не переведенного в муниципальную собственность при приватизации в 1994г.</p>Верховный Суд РФ неоднократно разъяснял, что если спорные помещения являются жилыми и поставляемые ресурсы используются исключительно на коммунально-бытовые нужды, то при расчете стоимости коммунальных услуг следует применять тариф, установленный для населения.<p>По результатам рассмотрения дела в апелляционной инстанции арбитражного суда (поддержано кассационной инстанцией) было отменено решение суда первой инстанции и вынесено новое решение в пользу юридического лица (взыскана задолженность, рассчитанная по тарифам «для населения»).</p><p>Основанием для отмены судебного акта первой инстанции послужило то, что адвокатам удалось доказать необходимость применения тарифа с учетом фактического использования помещений (для проживания граждан в общежитии), принадлежащих юридическому лицу. Представленные доказательства проживания физических лиц позволили подтвердить, что назначение жилого помещения не меняется в случае, если такое жилое помещение находится в собственности у юридического лица.</p><p>Апелляционный суд, соглашаясь с позицией адвокатов, указал в судебном акте, что иной подход ставит проживающих в жилых помещениях, принадлежащих юридическому лицу граждан и использующих жилые помещения для проживания в целях удовлетворения личных бытовых нужд и реализации конституционного права на жилище, в дискриминационное положение в сравнении с гражданами, проживающими в собственных жилых помещениях или жилых помещениях, принадлежащих на праве собственности публичным образованиям. Установление различных тарифов для одной группы недопустимо в силу того, что это ставит потребителей коммунальной услуги в неравное положение применительно к исполнению обязанности по оплате ресурсов, что не согласуется с общеправовыми принципами равенства и справедливости. Критерием отнесения потребителя к категории 'население' является использование ресурса в жилом помещении на коммунально-бытовые нужды.</p>"
        },
        {
            id: 3,
            title: "Скрыть реального владельца акционерного общества все сложнее - при участии адвокатов АК «АРГУС» суд субординировал требование аффилированного с должником кредитора",
            date: "2023-11-10",
            content: "<p>Компания обратилась в Арбитражный суд с заявлением о признании общества банкротом. Решением суда первой инстанции в отношении должника была введена процедура наблюдения. Однако Апелляционный суд не согласился с выводами суда первой инстанции в части установления очередности удовлетворения требований кредитора и назначения кандидатуры временного управляющего</p><p>Установив действительную корпоративную структуру владения акциями должника, наличие между должником и кредитором признаков аффилированности, осуществление Компанией компенсационного финансирования деятельности должника, апелляционный суд субординировал заявленное требование. Также апелляционный суд пришел к выводу, что арбитражный управляющий, кандидатура которого была предложена кредитором-заявителем, не отвечает требованиям законодательства о банкротстве и применил метод случайной выборки для выбора новой кандидатуры временного управляющего должником.</p>"
        },
        {
            id: 4,
            title: "Адвокатам АК «АРГУС» удалось отстоять административный иск к МИФНС по Санкт-Петербургу о признании безнадежной к взысканию задолженности по НДФЛ за 2017 год, а также начисленных пеней, и, соответственно, признании незаконным и не подлежащим исполнению решение МИФНС о взыскании задолженности за счет денежных средств на счетах.",
            date: "2022-08-05",
            content: "<p>Суд установил, что налоговый орган был не вправе включать задолженность налогоплательщика по уплате налога на доходы физических лиц за 2017 год в ЕНС (единый налоговый счет), а в дальнейшем, списывать произведенные налогоплательщиком оплаты и имеющиеся у него переплаты в счет погашения данной задолженности.</p><p>Одновременно суд установил, что неверное определение налоговым органом сальдо ЕНС налогоплательщика повлекло принятие ошибочного решения МИФНС, последующие произведенные оплаты налогоплательщиком также повлекли за собой неверное распределение денежных средств, в то время как налогоплательщик своевременно и в полном объеме оплатил налоги за 2022 год и страховые взносы за 2023 год</p><p>Доводы административного ответчика были опровергнуты административным истцом. Так, позиция налоговой инспекции о праве выставить налоговое требование по недоимкам, срок принудительного взыскания по которым истек на 01.01.2023г. была отклонена судом как основанные на неверном толковании норм материального права.</p><p>Требование об уплате задолженности, направленное после 1 января 2023г. может быть выставлено налоговым органом только в отношении тех недоимок, по которым до 31 декабря 2022 года направлялись требования о взыскании и не были предприняты меры взыскания, срок взыскания по которым не истек (в соответствии с действовавшими положениями ст.48 Налогового кодекса РФ – 6 месяцев либо 3 года 6 месяцев с даты истечения срока исполнения требования в зависимости от размера недоимки).</p><p>Кроме того, суд также отразил в решении – допущение налоговым органом того, что повторное требование может быть выставлено налогоплательщику в отношении задолженности за любой налоговый период бессрочно, тем самым аннулируя сроки, установленные для принудительного взыскания задолженности, и лишая возможности налогоплательщика заявить о безнадежности взыскания тех недоимок, по которым до 1 января 2023 года истек срок их взыскания, приводило бы к нарушению общих задач налогового законодательства, а также п.7 ст.3 Налогового кодекса РФ, согласно которому все неустранимые сомнения, противоречия и неясности актов законодательства о налогах и сборах толкуются в пользу налогоплательщика.</p>"
        },
    ];

    const publicationList = document.getElementById('publicationList');
    const searchInput = document.getElementById('searchInput');
    const yearFilter = document.getElementById('yearFilter');

    // Render publications
    function renderPublications(filteredPublications = publications) {
        publicationList.innerHTML = '';
        
        if (filteredPublications.length === 0) {
            publicationList.innerHTML = '<p class="no-results">No publications found matching your criteria.</p>';
            return;
        }
        
        filteredPublications.forEach(pub => {
            const pubDate = new Date(pub.date);
            const formattedDate = pubDate.toLocaleDateString('en-US', { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
            const year = pubDate.getFullYear();
            
            const pubElement = document.createElement('div');
            pubElement.className = 'publication-item';
            pubElement.innerHTML = `
                <div class="publication-header">
                    <div>
                        <h3 class="publication-title">${pub.title}</h3>
                        <p class="publication-date">Published on ${formattedDate}</p>
                    </div>
                    <button class="toggle-btn" aria-label="Toggle publication content">
                        <i class="fas fa-chevron-down"></i>
                    </button>
                </div>
                <div class="publication-content">
                    ${pub.content}
                </div>
            `;
            
            publicationList.appendChild(pubElement);
            
            // Add click event to toggle content
            const header = pubElement.querySelector('.publication-header');
            const content = pubElement.querySelector('.publication-content');
            const toggleBtn = pubElement.querySelector('.toggle-btn');
            
            header.addEventListener('click', () => {
                content.classList.toggle('expanded');
                toggleBtn.classList.toggle('expanded');
                
                // Close other expanded publications
                if (content.classList.contains('expanded')) {
                    document.querySelectorAll('.publication-content').forEach(item => {
                        if (item !== content && item.classList.contains('expanded')) {
                            item.classList.remove('expanded');
                            item.previousElementSibling.querySelector('.toggle-btn').classList.remove('expanded');
                        }
                    });
                }
            });
        });
    }

    // Filter publications based on search and year
    function filterPublications() {
        const searchTerm = searchInput.value.toLowerCase();
        const selectedYear = yearFilter.value;
        
        const filtered = publications.filter(pub => {
            const matchesSearch = pub.title.toLowerCase().includes(searchTerm) || 
                                  pub.content.toLowerCase().includes(searchTerm);
            
            const pubYear = new Date(pub.date).getFullYear().toString();
            const matchesYear = selectedYear === '' || pubYear === selectedYear;
            
            return matchesSearch && matchesYear;
        });
        
        renderPublications(filtered);
    }

    // Initialize
    renderPublications();

    // Event listeners
    searchInput.addEventListener('input', filterPublications);
    yearFilter.addEventListener('change', filterPublications);

    // Populate year filter dynamically
    function populateYearFilter() {
        const years = [...new Set(publications.map(pub => 
            new Date(pub.date).getFullYear().toString()
        ))].sort((a, b) => b - a);
        
        yearFilter.innerHTML = '<option value="">За все время</option>';
        years.forEach(year => {
            const option = document.createElement('option');
            option.value = year;
            option.textContent = year;
            yearFilter.appendChild(option);
        });
    }

    populateYearFilter();
});